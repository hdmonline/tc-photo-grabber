version: '3.8'

services:
  tc-photo-grabber:
    build: .
    container_name: tc-photo-grabber
    environment:
      # Mode: 'cli' for one-time run, 'cron' for scheduled
      - MODE=cron
      # Schedule options: 'hourly', 'daily', 'weekly', 
      # 'every X hours', 'every day at HH:MM'
      - SCHEDULE=daily
      # Transparent Classroom credentials
      - TC_EMAIL=${TC_EMAIL}
      - TC_PASSWORD=${TC_PASSWORD}
      - SCHOOL=${SCHOOL}
      - CHILD=${CHILD}
      - SCHOOL_LAT=${SCHOOL_LAT}
      - SCHOOL_LNG=${SCHOOL_LNG}
      - SCHOOL_KEYWORDS=${SCHOOL_KEYWORDS}
      # Directories
      - OUTPUT_DIR=/app/photos
      - CACHE_DIR=/app/cache
    volumes:
      # Mount local directory for photos
      - ./photos:/app/photos
      # Optional: mount cache directory
      - ./cache:/app/cache
    restart: unless-stopped
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
