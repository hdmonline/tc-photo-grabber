version: '3.8'

services:
  tc-photo-grabber:
    build: .
    container_name: tc-photo-grabber
    environment:
      # Mode: 'cli' for one-time run, 'cron' for scheduled
      - MODE=cron
      # Schedule options: 'hourly', 'daily', 'weekly', 
      # 'every X hours', 'every day at HH:MM'
      - SCHEDULE=daily
      # Optional: Cron expression (takes precedence over SCHEDULE)
      # Examples: "0 2 * * *" (daily at 2am), "*/30 * * * *" (every 30 min)
      # - CRON_EXPRESSION=0 2 * * *
      # Optional: Run immediately on startup (before first scheduled time)
      # - RUN_IMMEDIATELY=true
      # Optional: Telegram notifications
      # - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
      # - TELEGRAM_CHAT_ID=${TELEGRAM_CHAT_ID}
      # Transparent Classroom credentials
      - TC_EMAIL=${TC_EMAIL}
      - TC_PASSWORD=${TC_PASSWORD}
      - SCHOOL=${SCHOOL}
      - CHILD=${CHILD}
      - SCHOOL_LAT=${SCHOOL_LAT}
      - SCHOOL_LNG=${SCHOOL_LNG}
      - SCHOOL_KEYWORDS=${SCHOOL_KEYWORDS}
      # Directories
      - OUTPUT_DIR=/photos
      - CACHE_DIR=/cache
    volumes:
      # Mount local directory for photos
      - ./photos:/photos
      # Optional: mount cache directory
      - ./cache:/cache
    restart: unless-stopped
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
